<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Growth & Graphs</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons Components (Inline SVGs for portability) ---
        const IconBase = ({ size = 24, className = "", children }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Leaf = (props) => <IconBase {...props}><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></IconBase>;
        const Heart = (props) => <IconBase {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></IconBase>;
        const FlaskConical = (props) => <IconBase {...props}><path d="M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2"/><path d="M8.5 2h7"/><path d="M7 16h10"/></IconBase>;
        const Calendar = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></IconBase>;
        const Camera = (props) => <IconBase {...props}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></IconBase>;
        const Plus = (props) => <IconBase {...props}><path d="M5 12h14"/><path d="M12 5v14"/></IconBase>;
        const Trash2 = (props) => <IconBase {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></IconBase>;
        const Search = (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>;
        const MapPin = (props) => <IconBase {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconBase>;
        const BookOpen = (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>;
        const Microscope = (props) => <IconBase {...props}><path d="M6 18h8"/><path d="M3 22h18"/><path d="M14 22a7 7 0 1 0 0-14h-1"/><path d="M9 14h2"/><path d="M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z"/><path d="M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3"/></IconBase>;
        const Coffee = (props) => <IconBase {...props}><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="1" y2="4"/><line x1="10" x2="10" y1="1" y2="4"/><line x1="14" x2="14" y1="1" y2="4"/></IconBase>;
        const Upload = (props) => <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></IconBase>;
        const XIcon = (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>;

        // --- Configuration Data ---

        const LAB_CATEGORIES = [
          { id: 'experiment', label: 'Experiment', icon: FlaskConical },
          { id: 'fieldwork', label: 'Field Work', icon: Leaf },
          { id: 'planning', label: 'Planning', icon: Calendar },
          { id: 'literature', label: 'Literature', icon: BookOpen },
        ];

        const LIFE_CATEGORIES = [
          { id: 'daily', label: 'Daily Life', icon: Coffee },
          { id: 'date', label: 'Date Night', icon: Heart },
          { id: 'travel', label: 'Travel', icon: MapPin },
          { id: 'milestone', label: 'Milestone', icon: Camera },
        ];

        // --- Main Application ---

        function App() {
          // State
          const [activeTab, setActiveTab] = useState('lab');
          const [entries, setEntries] = useState([]);
          const [isModalOpen, setIsModalOpen] = useState(false);
          const [searchTerm, setSearchTerm] = useState('');
          
          // Form State
          const [formTitle, setFormTitle] = useState('');
          const [formContent, setFormContent] = useState('');
          const [formCategory, setFormCategory] = useState('experiment');
          const [formImages, setFormImages] = useState([]);
          const fileInputRef = useRef(null);

          // Load from LocalStorage on mount
          useEffect(() => {
            const saved = localStorage.getItem('growth_graphs_entries');
            if (saved) {
              try {
                setEntries(JSON.parse(saved));
              } catch (e) {
                console.error("Failed to parse entries", e);
              }
            } else {
              // Initial seed data
              setEntries([
                {
                  id: '1',
                  type: 'lab',
                  title: 'Arabidopsis Thaliana Growth Series A',
                  content: 'Day 14: The specimens in the high-nitrogen group are showing 20% faster leaf expansion compared to the control group. Need to adjust the lighting schedule for next week.',
                  date: new Date().toISOString(),
                  images: [],
                  category: 'experiment',
                  location: 'Lab 304'
                },
                {
                  id: '2',
                  type: 'life',
                  title: 'Weekend Hiking Trip',
                  content: 'We finally took a break from the thesis writing to go hike the ridge. The view was incredible, and we even spotted some wild orchids!',
                  date: new Date().toISOString(),
                  images: [],
                  category: 'travel',
                  location: 'Blue Ridge Mountains'
                }
              ]);
            }
          }, []);

          // Save to LocalStorage whenever entries change
          useEffect(() => {
            localStorage.setItem('growth_graphs_entries', JSON.stringify(entries));
          }, [entries]);

          // Theme configuration
          const theme = {
            primary: activeTab === 'lab' ? 'emerald' : 'rose',
            bg: activeTab === 'lab' ? 'bg-emerald-50' : 'bg-rose-50',
            headerBg: activeTab === 'lab' ? 'bg-emerald-900' : 'bg-rose-900',
            accent: activeTab === 'lab' ? 'text-emerald-600' : 'text-rose-600',
            button: activeTab === 'lab' ? 'bg-emerald-600 hover:bg-emerald-700' : 'bg-rose-500 hover:bg-rose-600',
            border: activeTab === 'lab' ? 'border-emerald-200' : 'border-rose-200',
          };

          // Handlers
          const handleImageUpload = (e) => {
            if (e.target.files) {
              const file = e.target.files[0];
              const reader = new FileReader();
              reader.onloadend = () => {
                setFormImages(prev => [...prev, reader.result]);
              };
              reader.readAsDataURL(file);
            }
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            const newEntry = {
              id: Date.now().toString(),
              type: activeTab,
              title: formTitle,
              content: formContent,
              category: formCategory,
              images: formImages,
              date: new Date().toISOString(),
              location: activeTab === 'lab' ? 'Laboratory' : 'Home', 
            };

            setEntries([newEntry, ...entries]);
            resetForm();
            setIsModalOpen(false);
          };

          const deleteEntry = (id) => {
            if (confirm('Are you sure you want to delete this entry?')) {
              setEntries(entries.filter(ent => ent.id !== id));
            }
          };

          const resetForm = () => {
            setFormTitle('');
            setFormContent('');
            setFormImages([]);
            setFormCategory(activeTab === 'lab' ? 'experiment' : 'daily');
          };

          const openModal = () => {
            resetForm();
            setFormCategory(activeTab === 'lab' ? 'experiment' : 'daily');
            setIsModalOpen(true);
          };

          // Filter entries
          const filteredEntries = entries.filter(entry => 
            entry.type === activeTab && 
            (entry.title.toLowerCase().includes(searchTerm.toLowerCase()) || 
             entry.content.toLowerCase().includes(searchTerm.toLowerCase()))
          );

          // Render Helpers
          const renderCategoryIcon = (cat) => {
            const allCats = [...LAB_CATEGORIES, ...LIFE_CATEGORIES];
            const found = allCats.find(c => c.id === cat);
            const Icon = found ? found.icon : Leaf;
            return <Icon size={16} className="mr-1" />;
          };

          const getCategoryLabel = (cat) => {
            const allCats = [...LAB_CATEGORIES, ...LIFE_CATEGORIES];
            return allCats.find(c => c.id === cat)?.label || cat;
          };

          return (
            <div className={`min-h-screen transition-colors duration-500 ${theme.bg} font-sans text-slate-800`}>
              
              {/* --- Navigation Bar --- */}
              <nav className={`${theme.headerBg} text-white shadow-lg transition-colors duration-500 sticky top-0 z-10`}>
                <div className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
                  <div className="flex items-center justify-between h-16">
                    <div className="flex items-center space-x-3">
                      <div className="bg-white/20 p-2 rounded-lg backdrop-blur-sm">
                        {activeTab === 'lab' ? <Microscope size={24} /> : <Heart size={24} />}
                      </div>
                      <div>
                        <h1 className="text-xl font-bold tracking-tight">Growth & Graphs</h1>
                        <p className="text-xs text-white/80">Dr. Candidates Log</p>
                      </div>
                    </div>
                    
                    {/* Switcher */}
                    <div className="flex bg-black/20 p-1 rounded-full backdrop-blur-sm">
                      <button
                        onClick={() => setActiveTab('lab')}
                        className={`flex items-center px-4 py-1.5 rounded-full text-sm font-medium transition-all ${
                          activeTab === 'lab' ? 'bg-white text-emerald-900 shadow-sm' : 'text-white/70 hover:text-white'
                        }`}
                      >
                        <FlaskConical size={14} className="mr-2" />
                        Lab Notebook
                      </button>
                      <button
                        onClick={() => setActiveTab('life')}
                        className={`flex items-center px-4 py-1.5 rounded-full text-sm font-medium transition-all ${
                          activeTab === 'life' ? 'bg-white text-rose-900 shadow-sm' : 'text-white/70 hover:text-white'
                        }`}
                      >
                        <Heart size={14} className="mr-2" />
                        Our Journey
                      </button>
                    </div>
                  </div>
                </div>
              </nav>

              {/* --- Main Content Area --- */}
              <main className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                
                {/* Header Stats & Search */}
                <div className="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4">
                  <div>
                    <h2 className={`text-3xl font-bold ${activeTab === 'lab' ? 'text-emerald-900' : 'text-rose-900'}`}>
                      {activeTab === 'lab' ? 'Research Timeline' : 'Couples Journal'}
                    </h2>
                    <p className={`${activeTab === 'lab' ? 'text-emerald-600' : 'text-rose-600'}`}>
                      {activeTab === 'lab' 
                        ? 'Documenting data, hypotheses, and breakthroughs.' 
                        : 'Documenting dates, travels, and memories.'}
                    </p>
                  </div>

                  <div className="flex items-center gap-3">
                    <div className="relative">
                      <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                        <Search size={18} />
                      </span>
                      <input
                        type="text"
                        placeholder="Search entries..."
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                        className="pl-10 pr-4 py-2 rounded-full border border-gray-200 focus:outline-none focus:ring-2 focus:ring-opacity-50 w-full md:w-64 bg-white shadow-sm"
                        style={{ 
                          '--tw-ring-color': activeTab === 'lab' ? '#059669' : '#e11d48' 
                        }}
                      />
                    </div>
                    <button
                      onClick={openModal}
                      className={`${theme.button} text-white px-4 py-2 rounded-full shadow-lg flex items-center font-medium transition-transform hover:scale-105 active:scale-95`}
                    >
                      <Plus size={18} className="mr-2" />
                      New Entry
                    </button>
                  </div>
                </div>

                {/* Empty State */}
                {filteredEntries.length === 0 && (
                  <div className="text-center py-20 opacity-60">
                    <div className={`inline-block p-6 rounded-full mb-4 ${activeTab === 'lab' ? 'bg-emerald-100 text-emerald-400' : 'bg-rose-100 text-rose-400'}`}>
                      <BookOpen size={48} />
                    </div>
                    <h3 className="text-xl font-medium text-gray-900">No entries found</h3>
                    <p className="text-gray-500 mt-1">Start documenting your {activeTab === 'lab' ? 'research' : 'memories'} today.</p>
                  </div>
                )}

                {/* Entries Grid */}
                <div className="grid grid-cols-1 gap-6">
                  {filteredEntries.map((entry) => (
                    <div 
                      key={entry.id} 
                      className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow duration-300"
                    >
                      <div className="p-6">
                        <div className="flex justify-between items-start">
                          <div className="flex items-center gap-3 mb-3">
                            <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                              activeTab === 'lab' ? 'bg-emerald-100 text-emerald-800' : 'bg-rose-100 text-rose-800'
                            }`}>
                              {renderCategoryIcon(entry.category)}
                              {getCategoryLabel(entry.category)}
                            </span>
                            <span className="text-gray-400 text-sm flex items-center">
                              <Calendar size={12} className="mr-1" />
                              {new Date(entry.date).toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                            </span>
                          </div>
                          
                          <button 
                            onClick={() => deleteEntry(entry.id)}
                            className="text-gray-400 hover:text-red-500 transition-colors"
                          >
                            <Trash2 size={16} />
                          </button>
                        </div>

                        <h3 className="text-xl font-bold text-gray-900 mb-2">{entry.title}</h3>
                        
                        <div className="prose prose-sm max-w-none text-gray-600 whitespace-pre-wrap mb-4">
                          {entry.content}
                        </div>

                        {/* Image Gallery */}
                        {entry.images.length > 0 && (
                          <div className="grid grid-cols-2 sm:grid-cols-3 gap-2 mt-4">
                            {entry.images.map((img, idx) => (
                              <div key={idx} className="relative aspect-square rounded-lg overflow-hidden bg-gray-100">
                                <img src={img} alt="Entry attachment" className="w-full h-full object-cover" />
                              </div>
                            ))}
                          </div>
                        )}

                        {/* Footer Metadata */}
                        {entry.location && (
                          <div className="mt-4 pt-4 border-t border-gray-50 flex items-center text-xs text-gray-400 font-medium uppercase tracking-wide">
                             <MapPin size={12} className="mr-1" />
                             {entry.location}
                          </div>
                        )}
                      </div>
                    </div>
                  ))}
                </div>

              </main>

              {/* --- Create Modal --- */}
              {isModalOpen && (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
                  <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                    <div className={`p-6 ${theme.headerBg} text-white flex justify-between items-center sticky top-0 z-10`}>
                      <h3 className="text-lg font-bold flex items-center">
                        {activeTab === 'lab' ? <FlaskConical className="mr-2" size={20}/> : <Heart className="mr-2" size={20}/>}
                        New {activeTab === 'lab' ? 'Lab Entry' : 'Journal Entry'}
                      </h3>
                      <button onClick={() => setIsModalOpen(false)} className="text-white/70 hover:text-white">
                        <XIcon size={24} />
                      </button>
                    </div>
                    
                    <form onSubmit={handleSubmit} className="p-6 space-y-6">
                      
                      {/* Category Selection */}
                      <div className="grid grid-cols-2 sm:grid-cols-4 gap-3">
                        {(activeTab === 'lab' ? LAB_CATEGORIES : LIFE_CATEGORIES).map((cat) => {
                          const IconComp = cat.icon;
                          return (
                            <button
                              key={cat.id}
                              type="button"
                              onClick={() => setFormCategory(cat.id)}
                              className={`flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-all ${
                                formCategory === cat.id 
                                  ? `${activeTab === 'lab' ? 'border-emerald-500 bg-emerald-50 text-emerald-700' : 'border-rose-500 bg-rose-50 text-rose-700'}` 
                                  : 'border-gray-100 text-gray-500 hover:border-gray-200'
                              }`}
                            >
                              <IconComp size={20} className="mb-1" />
                              <span className="text-xs font-medium">{cat.label}</span>
                            </button>
                          );
                        })}
                      </div>

                      {/* Inputs */}
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Title</label>
                          <input
                            required
                            type="text"
                            value={formTitle}
                            onChange={(e) => setFormTitle(e.target.value)}
                            placeholder={activeTab === 'lab' ? "e.g., PCR Protocol Revision 3" : "e.g., Anniversary Dinner"}
                            className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-opacity-50 transition-all"
                            style={{ 
                              '--tw-ring-color': activeTab === 'lab' ? '#059669' : '#e11d48' 
                            }}
                          />
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Details</label>
                          <textarea
                            required
                            rows={6}
                            value={formContent}
                            onChange={(e) => setFormContent(e.target.value)}
                            placeholder={activeTab === 'lab' ? "Methodology, observations, results..." : "How did the day go? What was the highlight?"}
                            className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-opacity-50 transition-all resize-none"
                            style={{ 
                              '--tw-ring-color': activeTab === 'lab' ? '#059669' : '#e11d48' 
                            }}
                          />
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">Photos</label>
                          <div className="flex items-center space-x-4">
                            <button
                              type="button"
                              onClick={() => fileInputRef.current?.click()}
                              className="flex items-center justify-center px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 transition-colors text-sm"
                            >
                              <Upload size={16} className="mr-2" />
                              Add Image
                            </button>
                            <input
                              ref={fileInputRef}
                              type="file"
                              accept="image/*"
                              className="hidden"
                              onChange={handleImageUpload}
                            />
                            <span className="text-xs text-gray-400">
                              {formImages.length} image(s) selected
                            </span>
                          </div>
                          
                          {/* Image Previews */}
                          {formImages.length > 0 && (
                            <div className="flex gap-2 mt-3 overflow-x-auto pb-2">
                              {formImages.map((img, i) => (
                                <div key={i} className="relative shrink-0 w-20 h-20 rounded-md overflow-hidden border border-gray-200 group">
                                  <img src={img} alt="Preview" className="w-full h-full object-cover" />
                                  <button
                                    type="button"
                                    onClick={() => setFormImages(formImages.filter((_, idx) => idx !== i))}
                                    className="absolute inset-0 bg-black/50 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"
                                  >
                                    <Trash2 size={16} />
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      <div className="pt-4 border-t border-gray-100 flex justify-end gap-3">
                        <button
                          type="button"
                          onClick={() => setIsModalOpen(false)}
                          className="px-5 py-2 text-gray-600 font-medium hover:bg-gray-100 rounded-lg transition-colors"
                        >
                          Cancel
                        </button>
                        <button
                          type="submit"
                          className={`px-6 py-2 text-white font-medium rounded-lg shadow-md transition-all hover:scale-105 active:scale-95 ${theme.button}`}
                        >
                          Save Entry
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              )}

            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>